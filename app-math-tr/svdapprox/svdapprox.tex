\documentclass[12pt,fleqn]{article}\usepackage{../common}
\begin{document}
Yaklasiksal SVD ile Tavsiye Sistemleri

\begin{minted}[fontsize=\footnotesize]{python}
import pandas as pd
import ssvd; reload(ssvd)
d =  np.array(
[[  5.,   5.,   3.,  nan,   5.,   5.],
 [  5.,  nan,   4.,  nan,   4.,   4.],
 [ nan,   3.,  nan,   5.,   4.,   5.],
 [  5.,   4.,   3.,   3.,   5.,   5.],
 [  5.,   5.,  nan,  nan,  nan,   5.]
])
data = pd.DataFrame (d,
    columns=['0','1','2','3','4','5'],
    index=['Ben','Tom','John','Fred','Bob'])
mu,b_u,b_i,q_i,p_u = ssvd.ssvd(data,rank=3)
print mu
print 'b_u',b_u
print 'b_i',b_i
print 'q_i',q_i
print 'p_u',p_u
u = 4; i = 2
r_ui_hat = mu + b_i[i] + b_u[u] + np.dot(q_i[:,i].T,p_u[u,:])
print r_ui_hat
\end{minted}

\begin{verbatim}
3
5 6
4.31388888889
b_u [ 0.0886944   0.05933122  0.06104905  0.04271818  0.10839186]
b_i [ 0.11786797  0.05972506  0.01061162  0.06061645  0.08115571  0.10956981]
q_i [[ 0.08185888  0.07721267  0.07355249  0.07792275  0.07886466  0.08083053]
 [ 0.08185888  0.07721267  0.07355249  0.07792275  0.07886466  0.08083053]
 [ 0.08185888  0.07721267  0.07355249  0.07792275  0.07886466  0.08083053]]
p_u [[ 0.07933801  0.07933801  0.07933801]
 [ 0.07723364  0.07723364  0.07723364]
 [ 0.07740027  0.07740027  0.07740027]
 [ 0.07555062  0.07555062  0.07555062]
 [ 0.08138767  0.08138767  0.08138767]]
4.45085116027
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
import pandas as pd, os
df = pd.read_csv("%s/Downloads/movielens.csv" % os.environ['HOME'] ,sep=';')
print df.shape
df = df.ix[:,1:3700] # id kolonunu atla,
df.columns = range(3699)
print df.shape
\end{minted}

\begin{verbatim}
(6040, 3731)
(6040, 3699)
\end{verbatim}

\begin{minted}[fontsize=\footnotesize]{python}
import ssvd; reload(ssvd)
df_train, test_data = ssvd.create_training_test(df)
print len(test_data)
\end{minted}

\begin{verbatim}
6040
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
import ssvd; reload(ssvd)
mu,b_u,b_i,q_i,p_u = ssvd.ssvd(df_train,rank=25)
print mu
\end{minted}

\begin{verbatim}
25
6040 3699
3.23828836099
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
rmse = 0; n = 0
for u,i,real in test_data:
    r_ui_hat = mu + b_i[i] + b_u[u] + np.dot(q_i[:,i].T,p_u[u,:])
    rmse += (real-r_ui_hat)**2
    n += 1
    #print u,i,real, r_ui_hat
print "rmse", np.sqrt(rmse / n)
\end{minted}

\begin{verbatim}
rmse 0.938248517831
\end{verbatim}










Kaynaklar

http://sifter.org/~simon/journal/20061211.html

http://www.cs.bme.hu/nagyadat/Recommender_systems_handbook.pdf

http://www2.research.att.com/~volinsky/papers/ieeecomputer.pdf

http://www.cs.nyu.edu/~yann/talks/lecun-20071207-nonconvex.pdf

http://courses.cs.washington.edu/courses/cse528/09sp/sanger_pca_nn.pdf

http://users.ics.aalto.fi/oja/Oja1982.pdf

http://arxiv.org/pdf/1308.3509

http://www.maths.qmul.ac.uk/~wj/MTH5110/notes/MAS235_lecturenotes1.pdf

http://heim.ifi.uio.no/~tom/powerandqrslides.pdf

http://math.stackexchange.com/questions/649701/gradient-descent-on-non-convex-function-works-but-how

\end{document}
