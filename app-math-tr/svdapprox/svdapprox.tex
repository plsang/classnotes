\documentclass[12pt,fleqn]{article}\usepackage{../common}
\begin{document}
Yaklasiksal SVD ve Tavsiye Sistemleri

\begin{minted}[fontsize=\footnotesize]{python}
import pandas as pd
import ssvd; reload(ssvd)
d =  np.array(
[[  5.,   5.,   3.,  nan,   5.,   5.],
 [  5.,  nan,   4.,  nan,   4.,   4.],
 [ nan,   3.,  nan,   5.,   4.,   5.],
 [  5.,   4.,   3.,   3.,   5.,   5.],
 [  5.,   5.,  nan,  nan,  nan,   5.]
])
data = pd.DataFrame (d,
    columns=['0','1','2','3','4','5'],
    index=['Ben','Tom','John','Fred','Bob'])
mu,b_u,b_i,q_i,p_u = ssvd.ssvd(data)
print mu
print 'b_u',b_u
print 'b_i',b_i
print 'q_i',q_i
print 'p_u',p_u
\end{minted}

\begin{verbatim}
5 6
4.31388888889
b_u [ 0.10133903  0.09409426  0.09418718  0.08886431  0.10676199]
b_i [ 0.10901103  0.09410751  0.0818748   0.0946108   0.0992177   0.10642075]
q_i [[ 0.10086511  0.09937517  0.09815699  0.0994476   0.09988284  0.10059356]
 [ 0.10086511  0.09937517  0.09815699  0.0994476   0.09988284  0.10059356]
 [ 0.10086511  0.09937517  0.09815699  0.0994476   0.09988284  0.10059356]]
p_u [[ 0.100097    0.100097    0.100097  ]
 [ 0.09937763  0.09937763  0.09937763]
 [ 0.09938889  0.09938889  0.09938889]
 [ 0.09885517  0.09885517  0.09885517]
 [ 0.10065103  0.10065103  0.10065103]]
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
u = 4; i = 2
r_ui_hat = mu + b_i[i] + b_u[u] + np.dot(q_i[:,i].T,p_u[u,:])
print r_ui_hat
\end{minted}

\begin{verbatim}
4.53216448203
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
import pandas as pd, os
df = pd.read_csv("%s/Downloads/movielens.csv" % os.environ['HOME'] ,sep=';')
print df.shape
df = df.ix[0:1000,1:3700] # id kolonunu atla,
df.columns = range(3699)
print df.shape
\end{minted}

\begin{verbatim}
(6040, 3731)
(1001, 3699)
\end{verbatim}

\begin{minted}[fontsize=\footnotesize]{python}
print df.ix[110,10]
print df.ix[59,20]
df.ix[110,10] = nan
df.ix[59,20] = nan
print df.ix[110,10]
print df.ix[59,20]
\end{minted}

\begin{verbatim}
4.0
3.0
nan
nan
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
mu,b_u,b_i,q_i,p_u = ssvd.ssvd(df)
reload(ssvd)
import ssvd 
print mu
\end{minted}

\begin{verbatim}
1001 3699
3.2900967656
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
u=110;i=10
r_ui_hat = mu + b_i[i] + b_u[u] + np.dot(q_i[:,i].T,p_u[u,:])
print r_ui_hat
u=59;i=20
r_ui_hat = mu + b_i[i] + b_u[u] + np.dot(q_i[:,i].T,p_u[u,:])
print r_ui_hat
\end{minted}

\begin{verbatim}
3.77778381527
3.54456229482
\end{verbatim}

Kaynaklar

http://sifter.org/~simon/journal/20061211.html

http://www.cs.bme.hu/nagyadat/Recommender_systems_handbook.pdf

http://www2.research.att.com/~volinsky/papers/ieeecomputer.pdf

http://www.cs.nyu.edu/~yann/talks/lecun-20071207-nonconvex.pdf

http://courses.cs.washington.edu/courses/cse528/09sp/sanger_pca_nn.pdf

http://users.ics.aalto.fi/oja/Oja1982.pdf

http://arxiv.org/pdf/1308.3509

http://www.maths.qmul.ac.uk/~wj/MTH5110/notes/MAS235_lecturenotes1.pdf

http://heim.ifi.uio.no/~tom/powerandqrslides.pdf

http://math.stackexchange.com/questions/649701/gradient-descent-on-non-convex-function-works-but-how

\end{document}
